if(INSTALL_HERE)
  # install in the home of the whole project
  if ( ${CMAKE_HOME_DIRECTORY} STREQUAL ${CMAKE_CURRENT_SOURCE_DIR} )
    set(INSTALL_PREFIX "${CMAKE_CURRENT_SOURCE_DIR}/lib")
  else()
    set(INSTALL_PREFIX "${CMAKE_HOME_DIRECTORY}/lib3rd")
  endif()
  set(PROJECT_PUBLIC_HEADER_DESTINATION "${INSTALL_PREFIX}/include")
else()
  set(INSTALL_PREFIX "${CMAKE_INSTALL_PREFIX}")
  set(PROJECT_PUBLIC_HEADER_DESTINATION "${INSTALL_PREFIX}/include/${PROJECT_NAME}")
endif()

file(GLOB HDR       ./src/*.h*)
file(GLOB HDR1      ./src/Utils/*.h*)
file(GLOB HDR_FMT   ./src/Utils/fmt/*.h*)
file(GLOB HDR_ZS    ./src/Utils/zstream/*.h*)
file(GLOB HDR_MINGW ./src/Utils/mingw-std-threads/*.h* ./src/Utils/mingw-std-threads/README.* ./src/Utils/mingw-std-threads/LICENSE)
file(GLOB HDR_ZLIB  ./lib3rd/include/*.h*)
file(GLOB LIB_ZLIB  ./lib3rd/lib/*.*)
file(GLOB DLL_ZLIB  ./lib3rd/dll/*.*)

# FIXME: With targets defined in this method it is possible to automatically
# export and install headers (PUBLIC_HEADER and PRIVATE_HEADER)
# ref: https://cmake.org/cmake/help/latest/command/install.html#installing-targets
set(INSTALL_TARGET ${STATIC_PROJECT})
if(BUILD_SHARED)
  set(INSTALL_TARGET ${INSTALL_TARGET} ${DYNAMIC_PROJECT})
endif()
install(
  TARGETS ${INSTALL_TARGET}
  RUNTIME DESTINATION ${INSTALL_PREFIX}/bin
  LIBRARY DESTINATION ${INSTALL_PREFIX}/dll
  ARCHIVE DESTINATION ${INSTALL_PREFIX}/lib
  PUBLIC_HEADER DESTINATION ${PROJECT_PUBLIC_HEADER_DESTINATION}
)

install(FILES ${HDR}       DESTINATION ${PROJECT_PUBLIC_HEADER_DESTINATION})
install(FILES ${HDR1}      DESTINATION ${PROJECT_PUBLIC_HEADER_DESTINATION}/Utils)
install(FILES ${HDR_FMT}   DESTINATION ${PROJECT_PUBLIC_HEADER_DESTINATION}/Utils/fmt)
install(FILES ${HDR_ZS}    DESTINATION ${PROJECT_PUBLIC_HEADER_DESTINATION}/Utils/zstream)
install(FILES ${HDR_MINGW} DESTINATION ${PROJECT_PUBLIC_HEADER_DESTINATION}/Utils/mingw-std-threads)
install(FILES ${HDR_ZLIB}  DESTINATION ${PROJECT_PUBLIC_HEADER_DESTINATION})
install(DIRECTORY ./src/Eigen DESTINATION ${PROJECT_PUBLIC_HEADER_DESTINATION} )

install(FILES ${LIB_ZLIB}  DESTINATION ${INSTALL_PREFIX}/lib)
install(FILES ${DLL_ZLIB}  DESTINATION ${INSTALL_PREFIX}/dll)

if(INSTALL_HERE)
  add_custom_command(
    TARGET ${STATIC_PROJECT} POST_BUILD
    COMMAND cmake  --build . --config Release  --target install
  )
endif()
